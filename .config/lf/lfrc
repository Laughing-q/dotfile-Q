set icons
set shell bash
set shellopts '-eu'
set ifs "\n"

# cmds/functions
cmd open ${{
    case $(file --mime-type $f -b) in
        image/vnd.djvu|application/pdf|application/octet-stream) setsid -f zathura $fx >/dev/null 2>&1 ;;
        text/*) $EDITOR $fx;;
        image/x-xcf) setsid -f gimp $f >/dev/null 2>&1 ;;
        image/svg+xml) display -- $f ;;
        image/*) rotdir $f | grep -i "\.\(png\|jpg\|jpeg\|gif\|webp\|tif\|ico\)\(_large\)*$" | setsid -f sxiv -aio 2>/dev/null | lf-select & ;;
        audio/*) mpv --audio-display=no $f ;;
        video/*) setsid -f mpv $f -quiet >/dev/null 2>&1 ;;
        application/pdf|application/vnd*|application/epub*) setsid -f zathura $fx >/dev/null 2>&1 ;;
        application/pgp-encrypted) $EDITOR $fx ;;
        *) for f in $fx; do setsid -f $OPENER $f >/dev/null 2>&1; done;;
    esac
}}

cmd extract ${{
    set -f
    case $f in
        *.tar.bz|*.tar.bz2|*.tbz|*.tbz2) tar xjvf $f;;
        *.tar.gz|*.tgz) tar xzvf $f;;
        *.tar.xz|*.txz) tar xJvf $f;;
        *.zip) unzip $f;;
        *.rar) unrar x $f;;
        *.7z) 7z x $f;;
    esac
}}

# compress current file or selected files with tar and gunzip
cmd tar ${{
    set -f
    mkdir $1
    cp -r $fx $1
    tar czf $1.tar.gz $1
    rm -rf $1
}}

# compress current file or selected files with zip
cmd zip ${{
    set -f
    mkdir $1
    cp -r $fx $1
    zip -r $1.zip $1
    rm -rf $1
}}


# Keybindings
map i up
map k down
map j updir
map l open

# faster move
map I push 5i
map K push 5k

map D delete
map gpw cd /d/projects/workCode
map gpy cd /d/projects/research/yolov5
map gpp cd /d/projects
map gpm cd /d/projects/my_codebase
map gpd cd /d/projects/data_tools
map gps cd /d/projects/StudyCode
map gD cd ~/Desktop
map gd cd ~/下载
map gfe cd /e
map gfd cd /d
map gfa cd ~/.config/alacritty
map gff cd ~/.config
map gfr cd ~/.config/ranger
map gfb cd ~/.config/bin
map gfn cd ~/.config/nvim
map gfm cd ~/.config/mutt
map gfz cd ~/.config/zsh
map gft cd ~/.config/tmux
map gfl cd ~/.config/lazygit/


# search
map = search-next
map - search-prev
map = find-next
map - find-prev

map <backspace2> set hidden!

# autojump
cmd aj %lf -remote "send $id cd '$(autojump $1)'"
map a push :aj<space>

# fzf
cmd fzf $nvim $(find . -name "$1" | fzf)
map f push :fzf<space>

map S $ $SHELL
map E extract
