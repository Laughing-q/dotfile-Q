#!/bin/sh

tmpfile="/home/laughing/test/cmd_test4.txt"
# find command prompt
ps1=$(grep "\S" "$tmpfile" | tail -n 1 | sed 's/^\s*//' | cut -d' ' -f1)  
# ps1=$(grep "\S" "$tmpfile" | tail -n 1 | sed 's/^\s*//' | awk '{print$1" "$2}')  

chosen="$(grep -F "$ps1" "$tmpfile" | sed '$ d' | tac | \
  dmenu -p "Copy which command's output?" -i -l 10 | \
  sed 's/[0-9]\+:[0-9]\+:[0-9]\+//g')"

if echo $chosen | grep -q "git:(\S\+)"; then
  command="$(echo $chosen | \
    awk -F " " '{for (i=5;i<=(NF);i++)printf("%s ", $i);print ""}')"
    # sed 's/^(.*)//g; s/[0-9]\+:[0-9]\+:[0-9]\+//g')"
else
  command="$(echo $chosen | \
    awk -F " " '{for (i=4;i<=(NF);i++)printf("%s ", $i);print ""}')"
fi

# echo $command
# chosen="$(echo $chosen | sed 's/(/\\(/g; s/)/\\)/g')"
# ps1="$(echo $ps1 | sed 's/(/\\(/g; s/)/\\)/g')"
echo $chosen
echo $ps1

# eps1="$(echo "$ps1" | sed 's/[^^]/[&]/g; s/\^/\\^/g')"
# echo $ps1

# echo "$(awk "/^$chosen/{p=1;print;next} p&&/$ps1/{p=0};p" "$tmpfile")"
# echo "$(sed -n '/^(base) ➜  ~ cat site.json.*/,/^(base) ➜  ~.*/p' "$tmpfile")"
echo "$(sed -n '/^(base) ➜  ~ cat site.json.*/,/^(base) ➜  ~.*/p' "$tmpfile")"
